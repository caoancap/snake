(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();var u=(e=>(e.Food="food",e.Trap="trap",e.SnakeHead="head",e.SnakeTail="tail",e))(u||{}),a=(e=>(e[e.Slug=0]="Slug",e[e.Rat=1]="Rat",e[e.Frog=2]="Frog",e))(a||{}),p=(e=>(e[e.Up=0]="Up",e[e.Right=1]="Right",e[e.Down=2]="Down",e[e.Left=3]="Left",e))(p||{});const y={x:0,y:-1},m={x:1,y:0},S={x:0,y:1},w={x:-1,y:0},B={ARROWUP:y,ARROWRIGHT:m,ARROWDOWN:S,ARROWLEFT:w,W:y,D:m,S,A:w},T={[p.Up]:y,[p.Right]:m,[p.Down]:S,[p.Left]:w},l=21,L=3,U=()=>({x:Math.floor(Math.random()*l),y:Math.floor(Math.random()*l)}),v=()=>[y,m,S,w][Math.floor(Math.random()*4)],W=e=>e===a.Slug?a.Slug:[a.Slug,a.Rat,a.Frog][Math.floor(Math.random()*(e+1))],M=e=>({position:U(),direction:v(),type:W(e)}),H=e=>e&&Math.random()>.9?{position:v()}:null,G=()=>{const e=Math.floor(l/2);return{snake:{positions:Array.from({length:L},(t,o)=>({x:L-o-1,y:e})),direction:m},food:M(a.Slug),trap:null,gameOver:!1,gameRunning:!0}};let s=G();const q=()=>{const e=document.getElementById("board");for(let t=0;t<l*l;t+=1){const o=document.createElement("div");o.classList.add("cell"),e.appendChild(o)}return e},C=document.getElementById("score"),E=()=>s.snake.positions.length-L,b=()=>{C.innerHTML=String(E())},h=e=>e.y*l+e.x,I=e=>{const t=e.querySelectorAll(".cell"),[o,...r]=s.snake.positions,n=h(o),i=r.map(h),c=h(s.food.position),f=s.trap!==null?h(s.trap.position):null,g=Array(t.length);f!==null&&(g[f]=u.Trap),g[c]=u.Food,g[n]=u.SnakeHead,i.forEach(R=>g[R]=u.SnakeTail),t.forEach((R,N)=>{const d=[];switch(d.push("cell"),g[N]){case u.Trap:d.push("trap");break;case u.Food:switch(d.push("food"),s.food.type){case a.Slug:d.push("slug");break;case a.Rat:d.push("rat");break;case a.Frog:d.push("frog");break}break;case u.SnakeHead:d.push("snake");break;case u.SnakeTail:d.push("tail");break}R.className=d.join(" ")})},x=(e,t)=>e.x===t.x&&e.y===t.y,O=(e,t,o=1)=>{const r={x:e.x+t.x*o,y:e.y+t.y*o};return r.x=(r.x+l)%l,r.y=(r.y+l)%l,r},D=e=>{const t={...e},o=O(e.positions[0],e.direction);return t.positions=[o,...e.positions.slice(0,-1)],t},K=e=>{let t=!1,o=1;switch(e.type){case a.Slug:t=Math.random()>.98;break;case a.Rat:t=Math.random()>.8;break;case a.Frog:t=Math.random()>.94,o=2;break}if(t){const r=O(e.position,e.direction,o);return{...e,position:r}}return e},z=(e,t)=>{const[o,...r]=e.positions;return t!==null&&x(o,t.position)?!0:r.some(n=>x(n,o))},P=e=>{if(s.gameOver){alert("Game over!");return}const t=D(s.snake);z(t,s.trap)&&(s.gameOver=!0);let o=s.food,r=s.trap;const n=x(t.positions[0],s.food.position);if(n){t.positions.push({...s.snake.positions[t.positions.length-1]});let c=a.Slug;const f=E();switch(Math.floor(f/5)){case 0:c=a.Slug;break;case 1:c=a.Rat;break;default:c=a.Frog}o=M(c),r=H(f>7)}else o=K(s.food);s={...s,snake:t,food:o,trap:r},n&&b(),I(e),setTimeout(()=>P(e),200)},j=e=>{F(B[e.key.toLocaleUpperCase()])},k=e=>{F(T[e])},F=e=>{e!==void 0&&(s.snake.direction=e)},A=q();document.addEventListener("keydown",j);document.getElementById("up").addEventListener("mousedown",()=>k(p.Up));document.getElementById("right").addEventListener("mousedown",()=>k(p.Right));document.getElementById("down").addEventListener("mousedown",()=>k(p.Down));document.getElementById("left").addEventListener("mousedown",()=>k(p.Left));b();I(A);P(A);
